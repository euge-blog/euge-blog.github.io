<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Neural Networks Building Blocks" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Neural Networks Building Blocks" />
<meta property="og:description" content="Neural Networks Building Blocks" />
<link rel="canonical" href="http://localhost:4000/2017/11/01/nn-building-blocks.html" />
<meta property="og:url" content="http://localhost:4000/2017/11/01/nn-building-blocks.html" />
<meta property="og:site_name" content="Eugenio Culurciello Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-11-01T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Neural Networks Building Blocks" />
<meta name="twitter:site" content="@culurciello" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2017-11-01T00:00:00-04:00","datePublished":"2017-11-01T00:00:00-04:00","description":"Neural Networks Building Blocks","headline":"Neural Networks Building Blocks","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2017/11/01/nn-building-blocks.html"},"url":"http://localhost:4000/2017/11/01/nn-building-blocks.html"}</script>
<!-- End Jekyll SEO tag -->


  <title>Neural Networks Building Blocks | Eugenio Culurciello Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://www.favicon-generator.org/
-->



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">

<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png">
<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

<link rel="manifest" href="/assets/img/favicons/manifest.json">
<meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
    integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ="
    crossorigin="anonymous">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">




  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/logo.jpeg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Eugenio Culurciello Blog</a>
    </div>

    <div class="site-subtitle font-italic">Eugenio Culurciello Blog</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/culurciello" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/culurciello" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['culurciello','gmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
        <span>
          
          
          <a href="/2017">
            2017
          </a>
        </span>

        

      

        
        <span>
          
          
          <a href="/11">
            11
          </a>
        </span>

        

      

        
        <span>
          
          
          <a href="/01">
            01
          </a>
        </span>

        

      

        
          <span>Neural Networks Building Blocks</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->
  
  

  

  



<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Neural Networks Building Blocks</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Eugenio Culurciello
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Wed, Nov  1, 2017, 12:00 AM -0400"
  

  
  prep="on" >

  
  

  
    Nov  1, 2017
  

  <i class="unloaded">2017-11-01T00:00:00-04:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1058 words">5 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h1 id="neural-networks-building-blocks">Neural Networks Building Blocks</h1>

<p>Neural networks are made of smaller modules or building blocks, similarly to atoms in matter and logic gates in digital circuits.</p>

<p>Once you know what the blocks are, you can combine them to solve a variety of problems. Many new building blocks are added constantly, as smart minds discover them</p>

<p>What are these blocks? How can we use them? Follow me…</p>

<h1 id="weights">Weights</h1>

<p>Weights implement the  product of an input <em>i</em> with a weight value <em>w,</em> to produce an output <em>o</em>. Seems easy, but addition and multiplications are at the hearth of neural networks.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*6VEPC2jS6kqp4-8SYeT_Ew.png" alt="" /></p>

<p>weights implement the product of an input i with a weight value w to give an output o</p>

<h1 id="neurons"><strong>Neurons</strong></h1>

<p>Artificial neurons are one basic building block.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*9mndvDtRF0le-niGnpUKXg.png" alt="" /></p>

<p>neuron, inputs i, output o, weight w</p>

<p>They sum up some inputs  <em>i</em>  and use a  non-linearity  (added as separate block) to output (<em>o</em>) a non-liner version of the sum.</p>

<p>Neurons use weights <em>w</em> to take inputs and scale them, before summing the values.</p>

<h1 id="identity-layers"><strong>Identity layers</strong></h1>

<p>Identity layers just pass the input to the output.  Seem pretty bare, but they are an essential block of neural networks.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*4Z4y-PlSD3CCYkuSCGryiQ.png" alt="" /></p>

<p>identity: i=o</p>

<p>See below why. You will not be disappointed!</p>

<h1 id="non-linearities"><strong>Non-linearities</strong></h1>

<p><a href="http://secure-web.cisco.com/114BVa72ujh6SqVX2mZhAi1vTQk7On18K7Oj7L0IYtoI4u4BloFHD0iHzTGTVC8Yczua_5YEmskIjKaoBQHSRmyguCK6zD9VIxVeSbqfZJg8VmQxn3QrBTPojZZLxlX8BoRacPtJXy1VrZqDCO8qrCT1FV9FMMop7CnJ-Nveq6Fbj8JfwLbQ7ND5UJVJauSk8_t7i3eD-3WEuVP6d51IsBdHHyJ2O2SBeaEVWBq6bIU6Yvv8EANH9e5fOETAIHZxKXwVD2dg8CSTWAeJC_gelsVt5hW0YeYqV3b25iv92ZS89ux-DRHXnwEc4ZdzcJ9eC9zIEFyjjPeItK_898axoihASrAtVsV4o0a9jkoja52E/http%3A%2F%2Fpytorch.org%2Fdocs%2Fmaster%2Fnn.html%23non-linear-activations">http://pytorch.org/docs/master/nn.html#non-linear-activations</a></p>

<p>They take  the inner value of a neuron  and  transform  it with a  non-linerfunction  to produce a neuron output.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*09sMNZF5TbTnc9213bHkaA.png" alt="" /></p>

<p>non-linear module</p>

<p>The most popular are:  ReLU,  tang,  sigmoid.</p>

<h1 id="linear-layers"><strong>Linear layers</strong></h1>

<p><a href="http://secure-web.cisco.com/1azQI165a3_Srk7tGe3e5RO3AuauMBJKXzbBe2RuxaPvUMU6BDJOdgIiaO5PFiJ_ZiUSO2QcomR9iGlwRVIMVsQ_26i4regz1MLa7HyWnIJFhuZZWBCqerE8ml7_YhfR2mWYws9fijwTkHt0LS0cE8sc6B6nKflVOFeI5B12dLKat7PUnw7VIdj71QPEpBVTPsTjQs0ubWslOaH4bThWE2N7GvSQBZfSAXWUP9yeC8iacjvfmx9HTLZkgSnApZbsjS62vqO7oiWgkshuc77n52qwzZNxAhg5T9XImxfchIsEWNz8F7ad9cfKaTN4XqjjLVewFSCFUEy73D7jPoBYG_zF0fJM1DzjkvnW6ty12HdU/http%3A%2F%2Fpytorch.org%2Fdocs%2Fmaster%2Fnn.html%23linear-layers">http://pytorch.org/docs/master/nn.html#linear-layers</a></p>

<p>These layers are an array of neurons. Each take multiple inputs and produce multiple outputs.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*nQQo_uzpEyX1cqKy7Rb3lg.png" alt="" /></p>

<p>linear layer: input i and output o are vectors of any and different length. A weight matrix (left) and how it may be fully connected (right) show different version of the same linear layer.</p>

<p>The input and output number is arbitrary and of uncorrelated length.</p>

<p>These building blocks are basically an array of  linear  combinations of inputs scaled by weights.  Weights multiply inputs with an array of weight values, and they are usually learned with a learning algorithm.</p>

<p>Linear layers do not come with non-linearities, you will have to add it after each layer.  If you stack multiple layers, you will need a non-linearity between them, or they will all collapse to a single linear layer.</p>

<h1 id="convolutional-layers"><strong>Convolutional layers</strong></h1>

<p><a href="http://secure-web.cisco.com/1PvQjlvAcNaRZBxKcTENGxKo4nDou7FP0mrE674v_sO7SIqGsr49X-9xdZbosOH04LJQ0pbCWWYjXKe2Dac5SPDkOUu1RbZQpAkZ8RX1aj3vG93d6emzymegReIWVYntdcJDdMIqQrQQNFT0UiVhHIqP0iZ-u4jH0NO9D0LFc9NFsQy3GpSe99F8jWS0uGaht-KM2Q8SifVC55MBcMpFPlgf7rJH3NSSaUYBS0R05KtHxofyv5yQj9lEt29wurrzE2Muo6D-ATRHRF2FpcMbuWQt-vp8RnRPXIp0alzUE2yzeCp1m8Xa1EIioCEzU7SUS7tXKzVCAOw0AS0dG6uz9R1fLWGQJ31gmiD-n6xFB5lI/http%3A%2F%2Fpytorch.org%2Fdocs%2Fmaster%2Fnn.html%23convolution-layers">http://pytorch.org/docs/master/nn.html#convolution-layers</a></p>

<p>They are exactly like a linear layer, but each output neuron is connected to a locally constrained group of input neurons.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*QXGJipqJIFnpWf5Gcxlsiw.png" alt="" /></p>

<p>convolution is a 3d matrix operation: an inputs cuboid of data is multiplied by multiple kernels to produce an output cuboid of data. These are just a lot of multiplication and additions</p>

<p>This group is often called receptive-field, borrowing the name from neuroscience.</p>

<p>Convolutions can be performed in 1D, 2D, 3D… etc.</p>

<p>These basic block takes advantage of the local features of data, which are correlated in some kind of inputs.  If the inputs are correlated, then it makes more sense to look at a group of inputs rather than a single value like in a linear layer. Linear layer can be thought of a convolutions with 1 value per filters.</p>

<h1 id="recurrent-neural-network"><strong>Recurrent neural network</strong></h1>

<p><a href="http://secure-web.cisco.com/13GQO-wuQ9ecaT6mwpAAaunLXA--8O7lhOsL6-iIXMnrydb8TuOLW1AUv565yRyCBpEkbHdKG2CHJ4vKc_tH3MTZp1uWMbu6EQKcWJ2b-XpiuNBy_nJiZewxeRO4qZQMJL-8gG44MmkRwtRowMf4LGGZPpTqgI05XfznMMj4ib46H9HI-iR2MwQM_7AYWCXMzrRfqnhluSxCU8yOZStB1jL4pjWJcatHh7-FXpHT8iUw7g6_bLXjw2gIF9tMZPOXQ8C3GEmniCtzB3LAM6qD4OHL0Q2GTkAagB_8G4LRXZP9-kaSSTdSs9UEOwtiEANOrQkTmV0V6_u4m6ayNYmv1aixZnA-F2uhnvWKLFD9cT8Y/http%3A%2F%2Fpytorch.org%2Fdocs%2Fmaster%2Fnn.html%23rnn">http://pytorch.org/docs/master/nn.html#rnn</a></p>

<p>Recurrent neural networks are a special kind of linear layer, where the output of each neuron is fed back ad additional input of the neuron,  together with actual input.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*cT6qi3FmQwnHeu4jrzUxdw.png" alt="" /></p>

<p>RNN: outputs or an additional state are fed back (values at time t-1) as an input together with input i (at time t)</p>

<p>You can think of RNN as a combination of the input at instant <em>t</em> and the state/output of the same neuron at time <em>t-1</em>.</p>

<p>RNN can remember sequences of values, since they can recall previous outputs, which again are linear combinations of their inputs.</p>

<h1 id="attention-modules"><strong>Attention modules</strong></h1>

<p>Attention modules are simply a gating function for memories. If you want to specify which values in an array should be passed through attention, you use a linear layer to gate each input by some weighting function.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*z8dUDzw7mACx6CipXnJCRw.png" alt="" /></p>

<p>Attention module:  an input i vector is linearly combined by multiplying each value by a weight matrix and producing one or multiple outputs</p>

<p>Attention modules can be soft when the weights are real-valued and the inputs are thus multiplied by values. Attention is hard when weight are binary, and inputs are either 0 or passing through.  Outputs are also called attention head outputs. More info:  <a href="https://distill.pub/2016/augmented-rnns/">nice blog post</a>  and  <a href="http://akosiorek.github.io/ml/2017/10/14/visual-attention.html">another</a>.</p>

<h1 id="memories">Memories</h1>

<p>A basic building block that saves multiple values  in a  table.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*gPnM13AjfuM5WWYr4T07rw.png" alt="" /></p>

<p>memory, input i, ouput o, optional addressing a</p>

<p>This is basically just a multi-dimensional array. The table can be of any size and any dimensions. It can also be composed of multiple banks or heads.  Generally memory have a write function writes to all locations and reads from all location.  An attention-like module can focus reading and writing to specific locations.  See attention module below. More info:  <a href="https://distill.pub/2016/augmented-rnns/">nice blog post</a>.</p>

<h1 id="residual-modules"><strong>Residual modules</strong></h1>

<p>Residual modules are a simple combination of layers and pass-through layers or Identity layers (ah-ah! told you they were important!).</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/2017-11-01-nn-building-blocks/1*lAIlTSfgEQ6icUFitJ-1Tg.png" alt="" /></p>

<p>residual module can combine input with a cascade of other layers</p>

<p>They became famous in ResNet: <a href="https://secure-web.cisco.com/1m2KBT459sIUn25Js1Lqr8KDnMvJ54A39CJcVFZo6jb3JsCeVU9rePXk3lnUlgQjYZPxZYV5nxOuusHqDqoBWz0taiupxn52W6VLZ36Gmmisc5biFXzu0b_kmG9--GW3lSDSWo7vpEKJLWN9LoEhrXun51GFc6TSc2zAzn4YZ4ZCST_UjaDMyhXhylunKQZtouDu0xEzx79tXbUQNQ3NwSGAaqrFy-vkkd4m9KB5tXd_AXS0nNGAHLd93crUb9qdw_HOIRfhCZNJ3eCXCrJnwrPDjtXfhJtC88KXXeJJj0llv1uaLMMyASRARM-lI4FOFz_yMlFe9dti3BGUrMKB8CUyYM6VJtJ6n_M7ckP9EbFI/https%3A%2F%2Farxiv.org%2Fabs%2F1512.03385">https://arxiv.org/abs/1512.03385</a>, and they have revolutionized neural networks since.</p>

<h1 id="lstm-gru-etc"><strong>LSTM, GRU, etc.</strong></h1>

<p><a href="http://secure-web.cisco.com/1ejbHpJD78YKX2hlEDyUpZ07TXkC-gQfRpP7VyJqv9x_NbTYm9KJwFX-SnxuUPyVFkcAwFzuEfWz1IsqwYFJ8jnoAbA_6AS6f6EDvWu6u_3BkVcmkpCPFR7xhmujvY1ES5Yv0VCnNMFy5GVkKvci79UW29AouvZJnS1yX4d4zQPmLBI6gxeU0bLYDsvk73YVGk_R9zeIFp6U223ABAUftab6OsCog-6oCUPOc0QY6pnSidXMQnr1GW4J7mQHyFSFJel90m6fqf5uXGRHBq2JpoFMaXlh0I5hwvDrthNvikc8swAKxkxJF-uWrCeyW2bPrnV4ncex3f5OVtF70LYX9wrkGqKbf_sOfqvSe1LS-5H0/http%3A%2F%2Fpytorch.org%2Fdocs%2Fmaster%2Fnn.html%23recurrent-layers">http://pytorch.org/docs/master/nn.html#recurrent-layers</a></p>

<p>These units use an RNN, residual modules and multiple Attention modules to gate inputs, outputs and state values (and more) of an RNN,  to produce augmented RNN that can remember longer sequence in the future. More info and figures:  <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">great post</a>  and  <a href="https://distill.pub/2016/augmented-rnns/">nice blog post</a>.</p>

<h1 id="neural-networks"><strong>Neural networks</strong></h1>

<p>Now the hard part: how do you  <a href="https://towardsdatascience.com/neural-network-architectures-156e5bad51ba">combine these modules to make neural networks</a>  that can actually solve interesting problems in the world?</p>

<p>So far it has been  human smart minds  that  architected these neural networktopologies.</p>

<p>But why, did you not tell me that neural network were all about learning from data? And yet the most important things or all, the network architecture is still designed by hand? What?</p>

<h1 id="this-list-will-grow-stay-tuned"><strong>This list will grow, stay tuned.</strong></h1>

<p>—</p>

<p><strong>PS1:</strong>  I do wish some smart minds can help me to find automatic ways to learn neural network  architectures  from data and the problem they need to solve.</p>

<p>If we can do this, we can also create machines that can build their own circuits topologies, and self-evolve. This would be a blast. And my work would be done. Ah, I can finally enjoy life!</p>

<h1 id="about-the-author">About the author</h1>

<p>I have almost 20 years of experience in neural networks in both hardware and software (a rare combination). See about me here:  <a href="https://medium.com/@culurciello/">Medium</a>,  <a href="https://e-lab.github.io/html/contact-eugenio-culurciello.html">webpage</a>,  <a href="https://scholar.google.com/citations?user=SeGmqkIAAAAJ">Scholar</a>,  <a href="https://www.linkedin.com/in/eugenioculurciello/">LinkedIn</a>, and more…</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        

        <!-- tags -->
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Neural Networks Building Blocks - Eugenio Culurciello Blog&url=http://localhost:4000/2017/11/01/nn-building-blocks.html" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Neural Networks Building Blocks - Eugenio Culurciello Blog&u=http://localhost:4000/2017/11/01/nn-building-blocks.html" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Neural Networks Building Blocks - Eugenio Culurciello Blog&url=http://localhost:4000/2017/11/01/nn-building-blocks.html" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  

















  
  </div> <!-- .access -->

  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->




  
    
    
      
      
        
        
        
      
    
  
    
    
      
      
        
        
        
      
    
  
    
    
      
      
        
        
        
          





  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/2023/05/24/Should-we-worry-about-AI.html">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 24
  

  <i class="unloaded">2023-05-24T00:00:00-04:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Should we worry about AI (machine-learning)?</h3>
            <div class="text-muted small">
              <p>
                





                Should we worry about AI (machine-learning)?

I have to start this discussion with a note. AI = artificial intelligence. What that really means is not well defined. In my mind…



Artificial intell...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/2023/03/30/A-picture-is-worth-a-1000-words.html">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Mar 30
  

  <i class="unloaded">2023-03-30T00:00:00-04:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>A picture is worth a 1000 words</h3>
            <div class="text-muted small">
              <p>
                





                A picture is worth a 1000 words

Evolution of large language models into artificial brains through multiple sensory modalities



As surprising as it is our very human predictive abilities hide a p...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/2023/01/25/Transformers-GPT.html">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Jan 25
  

  <i class="unloaded">2023-01-25T00:00:00-05:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>How can we make Transformers, Large Language models, GPT, more sharable? How can we make them grow?</h3>
            <div class="text-muted small">
              <p>
                





                How can we make Transformers, Large Language models, GPT, more sharable? How can we make them grow?



language models and transformers in  https://huggingface.co/spaces/stabilityai/stable-diffusio...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/2017/10/26/segmenting-nn.html" class="btn btn-outline-primary"
    prompt="Older">
    <p>Segmenting Nn</p>
  </a>
  

  
  <a href="/2017/11/07/nn-capsules.html" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Deep Neural Network Capsules</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



  <!--
  image lazy load: https://github.com/ApoorvSaxena/lozad.js
-->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>

<script type="text/javascript">
  const imgs = document.querySelectorAll('.post-content img');
  const observer = lozad(imgs);
  observer.observe();
</script>




        <!-- The Footer -->

<footer>
  <div class="container pl-lg-4 pr-lg-4">
    <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3">
      <div class="footer-left">
        <p class="mb-0">
          © 2023
          <a href="https://twitter.com/culurciello">Eugenio Culurciello</a>.
          <!--  -->
        </p>
      </div>

      <div class="footer-right">
        <p class="mb-0">

          <!--Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>. -->
        </p>
      </div>
    </div>
  </div>
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      

















      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://localhost:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

